<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="author" content="Fraunhofer FKIE"/>
    <meta name="description" content="Distribution of Windows API usage styles based on the data of Malpedia."/>
    

    <title>WinAPI Usage Statistics</title>

    <link href="/static/malpediasite/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/malpediasite/css/malpedia.css" rel="stylesheet">
    <link href="/static/malpediasite/font-awesome-5.7.0/css/all.min.css" rel="stylesheet">

    <link rel="apple-touch-icon" sizes="57x57" href="/static/malpediasite/icon/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/malpediasite/icon/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/malpediasite/icon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/malpediasite/icon/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/malpediasite/icon/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/malpediasite/icon/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/malpediasite/icon/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/malpediasite/icon/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/malpediasite/icon/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/android-chrome-36x36.png" sizes="36x36">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/android-chrome-48x48.png" sizes="48x48">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/android-chrome-72x72.png" sizes="72x72">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/android-chrome-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/android-chrome-144x144.png" %}" sizes="144x144">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/static/malpediasite/icon/favicon-96x96.png" sizes="96x96">
    <link rel="shortcut icon" type="image/x-icon" href="/static/malpediasite/icon/favicon.ico">
    <meta name="msapplication-TileImage" content="/static/malpediasite/icon/mstile-150x150.png">
    <meta name="msapplication-square70x70logo" content="/static/malpediasite/icon/mstile-70x70.png">
    <meta name="msapplication-square150x150logo" content="/static/malpediasite/icon/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/static/malpediasite/icon/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/static/malpediasite/icon/mstile-310x310.png">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-320x460.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-640x920.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-640x1096.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-748x1024.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 1) and (orientation: landscape)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-750x1024.png" media="" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-750x1294.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-768x1004.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 1) and (orientation: portrait)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-1182x2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-1242x2148.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-1496x2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" rel="apple-touch-startup-image">
    <link href="/static/malpediasite/icon/apple-touch-startup-image-1536x2008.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" rel="apple-touch-startup-image">
    
  </head>

  <body>
  <script src="/static/malpediasite/js/auto_darkmode.js"></script>
  <div class="container"><noscript>Please enable JavaScript to use all features of this site. </noscript><nav class="navbar navbar-toggleable-md navbar-light bg-faded clearfix"><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbar_toggle" aria-controls="navbar_toggle" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><a class="navbar-brand float-left hidden-md-down" href="/"><img class="navbar-logo" src="/static/malpediasite/logo.png"><img class="navbar-logo navbar-logo-dark" src="/static/malpediasite/logo_dark.png"></a><a class="navbar-brand-small float-left hidden-lg-up" href="/"><img class="navbar-logo" src="/static/malpediasite/logo.png"><img class="navbar-logo navbar-logo-dark" src="/static/malpediasite/logo_dark.png"></a><div class="collapse navbar-collapse mt-lg-auto ml-lg-auto" id="navbar_toggle"><hr class="hidden-lg-up" /><ul class="navbar-nav ml-lg-auto"><li class="nav-item "><a class="nav-link" href="/library">Inventory</a></li><!----><li class="nav-item active"><a class="nav-link" href="/stats/general">Statistics</a></li><li class="nav-item "><a class="nav-link" href="/usage/tos">Usage</a></li><li class="nav-item"><a class="nav-link" href="/apiqr/">ApiVector</a></li><li class="nav-item"><a class="nav-link" href="/login">Login</a></li></ul></div><a class="right-logo hidden-md-down" target="_blank" href="https://www.fkie.fraunhofer.de/"><img class="navbar-logo" src="/static/malpediasite/fkie_logo.png"><img class="navbar-logo navbar-logo-dark" src="/static/malpediasite/fkie_logo_dark.png"></a></nav><ul class="nav nav-pills" role="tablist"><li class="nav-item"><a class="nav-link " href="/stats/general">General</a></li><li class="nav-item"><a class="nav-link " href="/stats/yara">YARA</a></li><li class="nav-item"><a class="nav-link " href="/stats/timestamps">Timestamps</a></li><li class="nav-item"><a class="nav-link " href="/stats/linker_info">Linker Info</a></li><li class="nav-item"><a class="nav-link active" href="/stats/api_usage">WinAPI Usage</a></li><li class="nav-item"><a class="nav-link " href="/stats/api_dll_frequencies">WinAPI Frequencies</a></li></ul><hr><div class="row"><div class="col-xl-12"><h3>Windows API Usage Styles</h3><p>Distribution of Windows API usage styles.</p></div></div><div class="row"><div class="col-lg-8"><div id="venn_api_usage"></div><b>It:</b> PE header defined ImportTable <br /><b>Dyn:</b> Dynamic imports that are cached in memory (detected by ApiScout) <br /><b>Obf:</b> Obfuscation schemes that avoid caching of the exact Windows API function offsets. <br /><style>
            .venntooltip {
              position: absolute;
              text-align: center;
              width: 128px;
              height: 24px;
              background: #333;
              color: #ddd;
              padding: 2px;
              border: 0px;
              border-radius: 8px;
              opacity: 0;
            }
            </style></div><div class="col-lg-4"><table class="table table-dark table-sm"><tr><td>IT</td><td>313 (47.86%)</td></tr><tr><td>DYN</td><td>198 (30.28%)</td></tr><tr><td>OBF</td><td>21 (3.21%)</td></tr><tr><td>IT+DYN</td><td>115 (17.58%)</td></tr><tr><td>IT+OBF</td><td>3 (0.46%)</td></tr><tr><td>DYN+OBF</td><td>3 (0.46%)</td></tr><tr><td>IT+DYN+OBF</td><td>1 (0.15%)</td></tr></table></div></div></div><footer class="footer bg-faded"><div class="container"><div class="col-xs-12"><a class="logo-red" href="/impressum">Impressum</a>
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
         <a class="logo-red" href="/datenschutzerklaerung">Datenschutzerkl&auml;rung</a><div class="float-right"><a style="margin-right:5px;" class="clickable-icon" href="/feeds/rss/latest" ><i class="logo-red fa fa-rss" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Latest RSS Feed"></i></a></div></div></div></footer><script src="/static/malpediasite/js/jquery-3.5.1.min.js"></script><script src="/static/malpediasite/js/tether.min.js"></script><script src="/static/malpediasite/js/bootstrap.min.js"></script><script src="/static/malpediasite/js/title_render.js"></script><script src="/static/malpediasite/js/d3.min.js"></script><script src="/static/malpediasite/js/venn.min.js"></script><script>
var chart = venn.VennDiagram()
.width(500)
.height(500);

var sets = [{"size": 313, "label": "IT", "sets": [0]}, {"size": 198, "label": "DYN", "sets": [1]}, {"size": 21, "label": "OBF", "sets": [2]}, {"size": 115, "label": "IT+DYN", "sets": [0, 1]}, {"size": 3, "label": "IT+OBF", "sets": [0, 2]}, {"size": 3, "label": "DYN+OBF", "sets": [1, 2]}, {"size": 1, "label": "IT+DYN+OBF", "sets": [0, 1, 2]}];

var div = d3.select("#venn_api_usage")
div.datum(sets).call(chart);
div.selectAll(".label")
.filter(function (d) { return d.size <= 5; })
.style("font-size", "0px");

var tooltip = d3.select("body").append("div")
.attr("class", "venntooltip");

div.selectAll("path")
.style("stroke-opacity", 0)
.style("stroke", "#fff")
.style("stroke-width", 3)

div.selectAll("g")
.on("mouseover", function(d, i) {
if (d.size > 5) {
// sort all the areas relative to the current item
venn.sortAreas(div, d);

// Display a tooltip with the current size
tooltip.transition().duration(400).style("opacity", .9);
tooltip.text(d.size + " Families");

// highlight the current path
var selection = d3.select(this).transition("tooltip").duration(400);
selection.select("path")
.style("fill-opacity", d.sets.length == 1 ? .4 : .1)
.style("stroke-opacity", 1);
} else {
// sort all the areas relative to the current item
venn.sortAreas(div, d);

// Display a tooltip with the current size
tooltip.transition().duration(400).style("opacity", .9);
tooltip.text(d.label + ": " + d.size);

// highlight the current path
var selection = d3.select(this).transition("tooltip").duration(400);
selection.select("path")
.style("fill-opacity", d.sets.length == 1 ? .4 : .1)
.style("stroke-opacity", 1);
}
})

.on("mousemove", function() {
tooltip.style("left", (d3.event.pageX) + "px")
.style("top", (d3.event.pageY - 28) + "px");
})

.on("mouseout", function(d, i) {
tooltip.transition().duration(400).style("opacity", 0);
var selection = d3.select(this).transition("tooltip").duration(400);
selection.select("path")
.style("fill-opacity", d.sets.length == 1 ? .25 : .0)
.style("stroke-opacity", 0);
});
</script>
  </body>
</html>
